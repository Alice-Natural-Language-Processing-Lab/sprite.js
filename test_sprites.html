<!DOCTYPE html><html>
<head>
<title>Test 32 sprites in a cycle animation</title>
<meta name = "viewport" content = "user-scalable=no, width=device-width">

</head>
<body>

<p>32 animated sprites: <span id="result"></span></p>

</body>
<script src="sprite.js"></script>
<script>

window.onload = function() {

    var sprites = [];
    sjs.use_canvas = false;

    for(var i=0; i<32; i++) {
        var sp = new sjs.Sprite('character.png');
        sp.h=55;
        sp.w=30;
        sp.yoffset=2;
        sp.x=8 * i + 10;
        sp.y=50 + ((i%4) * 60);
        sprites.push(sp);
    }

    var logo = new sjs.Sprite();
    logo.x = 120;
    logo.y = 150;
    logo.loadImg('spritejs.png');

    var cycle = new sjs.Cycle([[0, 2, 5],
                               [30, 2, 5],
                               [60, 2, 5],
                               [90, 2, 5],
                               [120, 2, 5],
                               [150, 2, 5],
                               [180, 2, 5]]);
    cycle.sprites = sprites;

    var ticker = new sjs.Ticker(35);

    var sin_cycle = 0,
        ms_to_render = 0,
        average_ms = 0,
        result = document.getElementById('result');

    function paint() {

        var start = new Date().getTime(),
            xv = Math.sin(ticker.current_tick / 15) * 2,
            xscale = xv < 0 ? 1 : -1;

        cycle.next(ticker.ticks_elapsed);
        for(var i=0, sp; sp = sprites[i]; i++) {
            sp.move(xv, 0)
              .scale(xscale, 1)
              .update();
        }

        logo.scale(xv)
            .rotate(0.02)
            .update();

        ms_to_render = ms_to_render + new Date().getTime() - start;
        if(ticker.current_tick % 60 == 0) {
            average_ms = Math.round(ms_to_render/60)
            result.innerHTML = average_ms + 'ms spent in the display loop.';
            ms_to_render = 0;
        }
    };
    ticker.run(paint);

};
</script>
</html>
